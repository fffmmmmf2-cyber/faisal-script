-- إنشاء ScreenGui كامل
local PlayerGui = game.Players.LocalPlayer:WaitForChild("PlayerGui")
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "PetScriptViewer"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = PlayerGui

-- ScrollFrame للقائمة الرئيسية
local ScrollFrame = Instance.new("ScrollingFrame")
ScrollFrame.Size = UDim2.fromScale(1,1)
ScrollFrame.Position = UDim2.fromScale(0,0)
ScrollFrame.CanvasSize = UDim2.new(0,0,0,0)
ScrollFrame.ScrollBarThickness = 12
ScrollFrame.BackgroundColor3 = Color3.fromRGB(40,40,40)
ScrollFrame.BorderSizePixel = 0
ScrollFrame.Parent = ScreenGui

-- Layout للقائمة
local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Padding = UDim.new(0,5)
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Parent = ScrollFrame

-- نافذة عرض الكود
local ScriptFrame = Instance.new("Frame")
ScriptFrame.Size = UDim2.fromScale(0.8,0.8)
ScriptFrame.Position = UDim2.fromScale(0.1,0.1)
ScriptFrame.Visible = false
ScriptFrame.BackgroundColor3 = Color3.fromRGB(30,30,30)
ScriptFrame.BorderSizePixel = 0
ScriptFrame.Parent = ScreenGui

local ScriptText = Instance.new("TextBox")
ScriptText.Size = UDim2.fromScale(1,1)
ScriptText.Position = UDim2.fromOffset(0,0)
ScriptText.TextWrapped = true
ScriptText.ClearTextOnFocus = false
ScriptText.MultiLine = true
ScriptText.TextXAlignment = Enum.TextXAlignment.Left
ScriptText.TextYAlignment = Enum.TextYAlignment.Top
ScriptText.BackgroundTransparency = 1
ScriptText.TextColor3 = Color3.fromRGB(255,255,255)
ScriptText.Font = Enum.Font.Code
ScriptText.TextSize = 14
ScriptText.TextEditable = false
ScriptText.Parent = ScriptFrame

-- زر نسخ الكود
local CopyButton = Instance.new("TextButton")
CopyButton.Size = UDim2.fromOffset(100,40)
CopyButton.Position = UDim2.fromScale(1,0) - UDim2.fromOffset(100,0)
CopyButton.AnchorPoint = Vector2.new(1,0)
CopyButton.Text = "نسخ الكود"
CopyButton.BackgroundColor3 = Color3.fromRGB(60,60,60)
CopyButton.TextColor3 = Color3.fromRGB(255,255,255)
CopyButton.Parent = ScriptFrame

CopyButton.MouseButton1Click:Connect(function()
    if setclipboard then
        setclipboard(ScriptText.Text)
    else
        warn("نسخ الكود غير مدعوم على هذا الجهاز")
    end
end)

-- زر رجوع
local BackButton = Instance.new("TextButton")
BackButton.Size = UDim2.fromOffset(100,40)
BackButton.Position = UDim2.fromOffset(10,10)
BackButton.Text = "رجوع"
BackButton.BackgroundColor3 = Color3.fromRGB(60,60,60)
BackButton.TextColor3 = Color3.fromRGB(255,255,255)
BackButton.Parent = ScriptFrame

BackButton.MouseButton1Click:Connect(function()
    ScriptFrame.Visible = false
    ScrollFrame.Visible = true
end)

-- دالة لإضافة زر لكل سكربت
local function AddScriptButton(scriptObj)
    local Btn = Instance.new("TextButton")
    Btn.Size = UDim2.new(1,0,0,40)
    Btn.Text = scriptObj.Name
    Btn.BackgroundColor3 = Color3.fromRGB(70,70,70)
    Btn.TextColor3 = Color3.fromRGB(255,255,255)
    Btn.Parent = ScrollFrame

    Btn.MouseButton1Click:Connect(function()
        local success, code = pcall(function()
            return scriptObj.Source
        end)
        if success then
            ScriptText.Text = code
            ScriptFrame.Visible = true
            ScrollFrame.Visible = false
        else
            ScriptText.Text = "-- لا يمكن عرض السكربت"
            ScriptFrame.Visible = true
            ScrollFrame.Visible = false
        end
    end)
end

-- البحث في كل السكربتات
local SearchFolders = {workspace, game:GetService("ServerScriptService")}
for _, folder in pairs(SearchFolders) do
    for _, obj in pairs(folder:GetDescendants()) do
        if obj:IsA("ModuleScript") or obj:IsA("Script") then
            if string.find(obj.Name:lower(), "pet") then
                AddScriptButton(obj)
            end
        end
    end
end
