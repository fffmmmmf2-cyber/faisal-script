-- إعدادات أساسية
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- إنشاء ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "PetScriptViewer"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = playerGui

-- الخلفية
local Background = Instance.new("Frame")
Background.Size = UDim2.fromScale(1,1)
Background.BackgroundColor3 = Color3.fromRGB(20,20,20)
Background.BackgroundTransparency = 0.2
Background.Parent = ScreenGui

-- Scroll Frame للسكربتات
local Scroll = Instance.new("ScrollingFrame")
Scroll.Size = UDim2.fromScale(1,1)
Scroll.Position = UDim2.fromScale(0,0)
Scroll.BackgroundTransparency = 1
Scroll.ScrollBarThickness = 10
Scroll.Parent = Background

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Parent = Scroll
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Padding = UDim.new(0,5)

UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    Scroll.CanvasSize = UDim2.new(0,0,0,UIListLayout.AbsoluteContentSize.Y)
end)

-- Frame لعرض محتوى السكربت
local ScriptFrame = Instance.new("Frame")
ScriptFrame.Size = UDim2.fromScale(0.9,0.9)
ScriptFrame.Position = UDim2.fromScale(0.05,0.05)
ScriptFrame.BackgroundColor3 = Color3.fromRGB(30,30,30)
ScriptFrame.Visible = false
ScriptFrame.Parent = Background

-- زر الرجوع
local CloseButton = Instance.new("TextButton")
CloseButton.Size = UDim2.fromOffset(100,40)
CloseButton.Position = UDim2.fromScale(0,0)
CloseButton.Text = "رجوع"
CloseButton.Parent = ScriptFrame

-- صندوق النص للسكربت، غير قابل للتعديل
local ScriptText = Instance.new("TextBox")
ScriptText.Size = UDim2.fromScale(1,1)
ScriptText.Position = UDim2.fromOffset(0,40)
ScriptText.TextXAlignment = Enum.TextXAlignment.Left
ScriptText.TextYAlignment = Enum.TextYAlignment.Top
ScriptText.TextWrapped = true
ScriptText.ClearTextOnFocus = false
ScriptText.MultiLine = true
ScriptText.TextColor3 = Color3.fromRGB(255,255,255)
ScriptText.BackgroundTransparency = 1
ScriptText.TextScaled = false
ScriptText.TextSize = 14
ScriptText.TextEditable = false -- يمنع الكتابة
ScriptText.Parent = ScriptFrame

CloseButton.MouseButton1Click:Connect(function()
    ScriptFrame.Visible = false
end)

-- دالة البحث عن السكربتات اللي فيها كلمة Pet
local function FindPetScripts()
    local containers = {
        workspace,
        ReplicatedStorage,
        player:WaitForChild("PlayerScripts"),
        game:GetService("StarterPlayer"):WaitForChild("StarterPlayerScripts")
    }
    local foundScripts = {}

    for _, container in pairs(containers) do
        for _, obj in pairs(container:GetDescendants()) do
            if obj:IsA("ModuleScript") or obj:IsA("LocalScript") or obj:IsA("Script") then
                local isPet = false
                if string.find(obj.Name, "[Pp][Ee][Tt]") then
                    isPet = true
                else
                    local success, content = pcall(function() return obj.Source end)
                    if success and content and string.find(content, "[Pp][Ee][Tt]") then
                        isPet = true
                    end
                end

                if isPet then
                    table.insert(foundScripts, obj)
                end
            end
        end
    end

    table.sort(foundScripts, function(a,b) return a.Name:lower() < b.Name:lower() end)

    -- عرض السكربتات في ScrollFrame
    for _, obj in pairs(foundScripts) do
        local TextLabel = Instance.new("TextButton")
        TextLabel.Size = UDim2.new(1,0,0,30)
        TextLabel.Text = obj:GetFullName()
        TextLabel.TextColor3 = Color3.fromRGB(255,255,255)
        TextLabel.BackgroundColor3 = Color3.fromRGB(40,40,40)
        TextLabel.BackgroundTransparency = 0.1
        TextLabel.TextScaled = true
        TextLabel.Parent = Scroll

        TextLabel.MouseButton1Click:Connect(function()
            local success, code = pcall(function() return obj.Source end)
            if success and code then
                ScriptText.Text = code
            else
                ScriptText.Text = "-- هذا السكربت محمي ولا يمكن عرض الكود"
            end
            ScriptFrame.Visible = true
        end)
    end
end

-- تنفيذ البحث عند تشغيل السكربت
FindPetScripts()
