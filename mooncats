-- PetMover Updated to Follow "Center" Part
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local ActivePetsData = {} -- لتخزين بتات اللاعبين محليًا

-- تسجيل بت جديد
local function RegisterPet(playerName, uuid, pet)
    if not ActivePetsData[playerName] then
        ActivePetsData[playerName] = {}
    end
    ActivePetsData[playerName][uuid] = {Asset = pet}
end

-- تحديث موقع البتات باتجاه البارت "Center"
local function UpdatePetPositions(deltaTime)
    for playerName, pets in pairs(ActivePetsData) do
        local player = Players:FindFirstChild(playerName)
        if player then
            local farm = workspace:FindFirstChild(playerName .. "_Farm")
            if farm then
                local centerPart = farm:FindFirstChild("Center")
                if centerPart then
                    for uuid, petData in pairs(pets) do
                        local pet = petData.Asset
                        if pet then
                            local direction = (centerPart.Position - pet.Position)
                            if direction.Magnitude > 0.1 then
                                -- يتحرك تدريجيًا باتجاه الـ Center بسرعة 5 studs/ثانية
                                pet.Position = pet.Position + direction.Unit * math.min(direction.Magnitude, deltaTime * 5)
                            end
                        end
                    end
                end
            end
        end
    end
end

-- تحديث كل إطار
RunService.RenderStepped:Connect(function(deltaTime)
    UpdatePetPositions(deltaTime)
end)

-- مثال لكيفية تسجيل البت عنده
-- RegisterPet("Player1", "PetUUID123", workspace:FindFirstChild("PetMover"))

return {
    RegisterPet = RegisterPet
}
