-- خدمات
local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

-- ================= GUI =================
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AnimuGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = Player:WaitForChild("PlayerGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 200, 0, 120)
frame.Position = UDim2.new(0.5, -100, 0.5, -60)
frame.BackgroundColor3 = Color3.fromRGB(50,50,50)
frame.BackgroundTransparency = 0.3
frame.Parent = screenGui
frame.Active = true
frame.Draggable = true

-- زر الإظهار
local toggleBtn = Instance.new("TextButton")
toggleBtn.Size = UDim2.new(0, 20, 0, 20)
toggleBtn.Position = UDim2.new(0, 0, 0, 0)
toggleBtn.Text = "+"
toggleBtn.TextColor3 = Color3.new(1,1,1)
toggleBtn.Parent = screenGui

spawn(function()
    while true do
        for i = 0,1,0.01 do
            toggleBtn.BackgroundColor3 = Color3.fromHSV(i,1,1)
            task.wait(0.03)
        end
    end
end)

toggleBtn.MouseButton1Click:Connect(function()
    frame.Visible = not frame.Visible
end)

-- ================= أزرار =================
local button1 = Instance.new("TextButton")
button1.Size = UDim2.new(0, 180, 0, 40)
button1.Position = UDim2.new(0, 10, 0, 10)
button1.Text = "Enemy ESP"
button1.TextColor3 = Color3.new(1,1,1)
button1.BackgroundColor3 = Color3.fromRGB(255,0,0)
button1.Parent = frame

local button2 = Instance.new("TextButton")
button2.Size = UDim2.new(0, 180, 0, 40)
button2.Position = UDim2.new(0, 10, 0, 60)
button2.Text = "NoClip"
button2.TextColor3 = Color3.new(1,1,1)
button2.BackgroundColor3 = Color3.fromRGB(0,0,255)
button2.Parent = frame

-- ================= Enemy ESP =================
local enemyESPScript = [[
local Players = game:GetService("Players")

local function apply(player)
    if player == Players.LocalPlayer then return end
    local function charAdded(char)
        local hum = char:WaitForChild("Humanoid")
        if char:FindFirstChild("EnemyHighlight") then
            char.EnemyHighlight:Destroy()
        end
        local h = Instance.new("Highlight")
        h.Name = "EnemyHighlight"
        h.Adornee = char
        h.FillColor = Color3.fromRGB(255,0,0)
        h.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
        h.Parent = char
    end
    if player.Character then
        charAdded(player.Character)
    end
    player.CharacterAdded:Connect(charAdded)
end

for _,p in pairs(Players:GetPlayers()) do
    apply(p)
end

Players.PlayerAdded:Connect(apply)
]]

button1.MouseButton1Click:Connect(function()
    loadstring(enemyESPScript)()
end)

-- ================= NoClip =================
button2.MouseButton1Click:Connect(function()
    loadstring(game:HttpGet(
        "https://raw.githubusercontent.com/fffmmmmf2-cyber/faisal-script/refs/heads/main/NoClip"
    ))()
end)

-- ================= Anti Fall =================
local lastSafeCFrame = nil
local fallTime = 0
local maxFallTime = 1.3

local function onCharacterAdded(char)
    lastSafeCFrame = nil
    fallTime = 0
end

if Player.Character then
    onCharacterAdded(Player.Character)
end
Player.CharacterAdded:Connect(onCharacterAdded)

RunService.Heartbeat:Connect(function(dt)
    local char = Player.Character
    if not char then return end
    local hrp = char:FindFirstChild("HumanoidRootPart")
    local hum = char:FindFirstChildOfClass("Humanoid")
    if not hrp or not hum then return end

    if hum.FloorMaterial ~= Enum.Material.Air then
        lastSafeCFrame = hrp.CFrame
        fallTime = 0
    else
        fallTime += dt
        if fallTime >= maxFallTime and lastSafeCFrame then
            hrp.CFrame = lastSafeCFrame

            local p = Instance.new("Part")
            p.Size = Vector3.new(3,1,3)
            p.Anchored = true
            p.CanCollide = true
            p.Transparency = 0.5
            p.BrickColor = BrickColor.new("Really black")
            p.Position = hrp.Position - Vector3.new(0,3,0)
            p.Parent = workspace

            fallTime = 0
        end
    end
end)
