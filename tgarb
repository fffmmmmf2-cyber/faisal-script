-- LocalScript في StarterPlayerScripts

local player = game.Players.LocalPlayer
local players = game.Players

local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
gui.Name = "ChaseGui"

-- الفريم الرئيسي
local Frame = Instance.new("Frame", gui)
Frame.Size = UDim2.new(0,200,0,150)
Frame.Position = UDim2.new(0,20,0.5,-75)
Frame.BackgroundColor3 = Color3.fromRGB(40,40,40)

-- زر اختيار اللاعب التالي
local NextPlayerBtn = Instance.new("TextButton", Frame)
NextPlayerBtn.Size = UDim2.new(1,0,0,50)
NextPlayerBtn.Position = UDim2.new(0,0,0,10)
NextPlayerBtn.Text = "التالي"
NextPlayerBtn.Font = Enum.Font.SourceSansBold
NextPlayerBtn.TextSize = 20
NextPlayerBtn.TextColor3 = Color3.new(1,1,1)
NextPlayerBtn.BackgroundColor3 = Color3.fromRGB(100,100,200)

-- زر الانتقال خلف اللاعب
local TeleportBtn = Instance.new("TextButton", Frame)
TeleportBtn.Size = UDim2.new(1,0,0,50)
TeleportBtn.Position = UDim2.new(0,0,0,70)
TeleportBtn.Text = "روح وراه"
TeleportBtn.Font = Enum.Font.SourceSansBold
TeleportBtn.TextSize = 20
TeleportBtn.TextColor3 = Color3.new(1,1,1)
TeleportBtn.BackgroundColor3 = Color3.fromRGB(200,100,100)

local playerList = {}
local index = 0
local targetPlayer = nil

-- تحديث قائمة اللاعبين
local function updatePlayers()
	playerList = {}
	for _, p in pairs(players:GetPlayers()) do
		if p ~= player then
			table.insert(playerList, p)
		end
	end
	if targetPlayer == nil or not targetPlayer.Parent then
		if #playerList > 0 then
			index = (index % #playerList) + 1
			targetPlayer = playerList[index]
			NextPlayerBtn.Text = "التالي: "..targetPlayer.DisplayName -- استخدم Nickname هنا
		else
			targetPlayer = nil
			NextPlayerBtn.Text = "لا يوجد لاعب"
		end
	end
end

updatePlayers()

players.PlayerAdded:Connect(updatePlayers)
players.PlayerRemoving:Connect(function(p)
	if p == targetPlayer then
		updatePlayers()
	end
end)

-- تغيير اللاعب عند الضغط على الزر
NextPlayerBtn.MouseButton1Click:Connect(function()
	if #playerList > 0 then
		index = (index % #playerList) + 1
		targetPlayer = playerList[index]
		NextPlayerBtn.Text = "التالي: "..targetPlayer.DisplayName -- Nickname
	end
end)

-- الانتقال خلف اللاعب لمدة 1 ثانية
TeleportBtn.MouseButton1Click:Connect(function()
	if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
		local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
		if hrp then
			local originalCFrame = hrp.CFrame
			local targetHRP = targetPlayer.Character.HumanoidRootPart
			local behindPos = targetHRP.CFrame.Position - targetHRP.CFrame.LookVector * 3
			hrp.CFrame = CFrame.new(behindPos, targetHRP.Position)
			wait(1) -- مدة ثانية كاملة
			if hrp then
				hrp.CFrame = originalCFrame
			end
		end
	end
end)
