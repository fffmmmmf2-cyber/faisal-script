local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

local LINE_LENGTH = 100
local LINE_THICKNESS = 0.3
local LINE_COLOR = Color3.fromRGB(255, 0, 0)

local lines = {}

local function createLine(player)
	if player == LocalPlayer then return end
	if lines[player] then return end

	local part = Instance.new("Part")
	part.Name = player.Name .. "_HEAD_LINE"
	part.Anchored = true
	part.CanCollide = false
	part.CastShadow = false
	part.Material = Enum.Material.Neon
	part.Color = LINE_COLOR
	part.Size = Vector3.new(LINE_THICKNESS, LINE_THICKNESS, LINE_LENGTH)
	part.Parent = workspace

	lines[player] = part
end

local function removeLine(player)
	if lines[player] then
		lines[player]:Destroy()
		lines[player] = nil
	end
end

-- إنشاء الخط
for _, player in ipairs(Players:GetPlayers()) do
	createLine(player)
end

Players.PlayerAdded:Connect(createLine)
Players.PlayerRemoving:Connect(removeLine)

-- تحديث الاتجاه والمكان
task.spawn(function()
	while true do
		for player, line in pairs(lines) do
			local char = player.Character
			if char and char:FindFirstChild("Head") and char.PrimaryPart then
				local head = char.Head
				local root = char.PrimaryPart

				local forward = root.CFrame.LookVector
				local startPos = head.Position + Vector3.new(0, 0.5, 0)
				local centerPos = startPos + (forward * (LINE_LENGTH / 2))

				line.CFrame = CFrame.new(centerPos, centerPos + forward)
			end
		end
		task.wait(0.1)
	end
end)
