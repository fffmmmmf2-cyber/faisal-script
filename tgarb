local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")

-- دالة لإنشاء واجهة التحديد
local function createSelectionGUI()
	local screenGui = Instance.new("ScreenGui")
	screenGui.Name = "SelectGUI"
	screenGui.Parent = playerGui

	local button = Instance.new("TextButton")
	button.Size = UDim2.new(0, 200, 0, 60)
	button.Position = UDim2.new(0.5, -100, 0.8, 0)
	button.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
	button.TextColor3 = Color3.new(1, 1, 1)
	button.TextScaled = true
	button.Text = "تحديد"
	button.Parent = screenGui

	return screenGui, button
end

-- دالة لإيجاد أقرب موديل
local function getClosestModel(maxDistance)
	local closestModel = nil
	local shortestDistance = maxDistance or 50

	for _, model in ipairs(workspace:GetChildren()) do
		if model:IsA("Model") and model ~= character and model:FindFirstChildWhichIsA("BasePart") then
			local part = model:FindFirstChildWhichIsA("BasePart")
			local distance = (hrp.Position - part.Position).Magnitude
			if distance < shortestDistance then
				shortestDistance = distance
				closestModel = model
			end
		end
	end

	return closestModel
end

-- دالة لتطبيق الرينبو الناعم
local function applyRainbow(model)
	task.spawn(function()
		while model and model.Parent do
			local t = tick() % 5 / 5
			local color = Color3.fromHSV(t, 1, 1)
			for _, part in ipairs(model:GetDescendants()) do
				if part:IsA("BasePart") then
					part.Color = color
				end
			end
			task.wait(0.05)
		end
	end)
end

-- إنشاء واجهة التحديد
local gui, button = createSelectionGUI()

button.MouseButton1Click:Connect(function()
	local closest = getClosestModel(50)
	if closest then
		applyRainbow(closest)
	end
	gui:Destroy() -- حذف الواجهة بعد التحديد
end)
